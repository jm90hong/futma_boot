<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="manager">	
	 		
	 		
	 		
	 		
	<select id="findByUserIdx" parameterType="Long" resultType="Manager">
		SELECT 
			*,
			AES_DECRYPT(UNHEX(bank_account_enc), 'futma') AS bank_account
	 	FROM manager
		WHERE user_idx=#{user_idx}
	</select> 		
	 
	 
	<update id="update" parameterType="Manager">
		UPDATE `manager`
		SET
			user_idx=#{user_idx},
			name=#{name},
			birth=#{birth}, 
			address=#{address}, 
			content=#{content}, 
			act_addr1=#{act_addr1}, 
			act_addr2=#{act_addr2}, 
			owner_ny=#{owner_ny}, 
			kakao_pay_link=#{kakao_pay_link}, 
			bank_name=#{bank_name},
			bank_account_enc=HEX(AES_ENCRYPT(#{bank_account},'futma')),
			created_date=SYSDATE()
		WHERE
			mng_idx=#{mng_idx}	
	</update> 
	 		
	<insert id="add" parameterType="Manager" useGeneratedKeys="true" keyProperty="mng_idx">
		INSERT INTO `manager`
		(
			user_idx,
			name, 
			birth, 
			address, 
			content, 
			act_addr1, 
			act_addr2, 
			owner_ny, 
			kakao_pay_link, 
			bank_name,
			bank_account_enc,
			created_date)
		VALUES
		(
			#{user_idx}, 
			#{name}, 
			#{birth}, 
			#{address}, 
			#{content}, 
			#{act_addr1}, 
			#{act_addr2}, 
			#{owner_ny},
			#{kakao_pay_link}, 
			#{bank_name},
			HEX(AES_ENCRYPT(#{bank_account},'futma')),
			SYSDATE()
		)
	</insert>	
	
	
	
	
	
	
	

</mapper>
